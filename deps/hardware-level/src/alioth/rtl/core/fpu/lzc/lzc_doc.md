# LZC（Leading Zero Counter）模块文档

## 1. 设计思路

LZC（Leading Zero Counter，前导零计数器）模块用于在输入数据中快速定位最高有效位1的位置，常用于浮点运算规格化、定点数归一化等场景。  
本系列模块采用分层递归结构，将大位宽输入递归拆分为小位宽模块，最终归约到基础的4位优先编码器（lzc_4）。  
每一级模块都输出最高位1的位置的二进制编码（而非前导零数量），并通过`valid`信号指示输入是否全为零。

## 2. 编码方式

- 输出`lzc`为最高位1的位置的二进制编码（MSB优先，0为最低位）。
- 输出`valid`为1表示输入数据中存在1，否则为0。
- 若输入全为0，`lzc`值无意义。

### 以lzc_8为例：

| data_in[7:0] | 最高位1位置 | lzc[2:0] | valid |
|:------------:|:-----------:|:--------:|:-----:|
| 1xxxxxxx     | 7           | 111      | 1     |
| 01xxxxxx     | 6           | 110      | 1     |
| ...          | ...         | ...      | ...   |
| 00000001     | 0           | 000      | 1     |
| 00000000     | -           | xxx      | 0     |

## 3. 层级结构

- **lzc_4**：基础4位优先编码器，输出2位位置编码。
- **lzc_8**：由2个lzc_4组成，输出3位位置编码。
- **lzc_16**：由2个lzc_8组成，输出4位位置编码。
- **lzc_32**：由2个lzc_16组成，输出5位位置编码。
- **lzc_64**：由2个lzc_32组成，输出6位位置编码。
- **lzc_128**：由2个lzc_64组成，输出7位位置编码。
- **lzc_256**：由2个lzc_128组成，输出8位位置编码。

每一级模块都采用如下递归结构：
- 拆分输入为高半区和低半区，分别递归调用下一级LZC模块。
- 若高半区存在1，则输出高半区的编码并在高位加偏移；否则输出低半区的编码。
- `valid`信号为高、低半区`valid`的或。

## 4. 使用方法

1. 例化对应位宽的LZC模块（如lzc_64）。
2. 连接输入数据至`data_in`端口。
3. 读取`lzc`输出，获得最高位1的位置编码。
4. 读取`valid`输出，判断输入是否全为0。

### 示例（以lzc_32为例）：

```systemverilog
logic [31:0] data;
logic [4:0]  lzc;
logic        valid;

lzc_32 u_lzc_32 (
    .data_in(data),
    .lzc    (lzc),
    .valid  (valid)
);
```

## 5. 注意事项

- 输出的`lzc`为最高位1的位置编码，不是前导零的数量。
- 若输入全为0，`valid`为0，`lzc`值无意义。
- 适用于高性能前导零检测场景。

---
